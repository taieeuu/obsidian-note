---
Date: 2024-08-27
---
`HTTP（Hypertext Transfer Protocol）`是一種在 `Web` 上傳輸數據的協議，屬於 `OSI` 模型的應用層。HTTP 的每個版本都具有向下兼容性，意味著新版本的 `HTTP` 可以與舊版本進行交互。無論是舊版本的 `HTTP` 客戶端還是服務器，都能在一定程度上與新版本的服務器和客戶端通信，確保不同版本之間的兼容性和互操作性。
### HTTP 版本
#### HTTP/0.9
- **引入時間**：1991 年
- **特點**：
    - 這是最早的 HTTP 協議版本，只有一個 GET 方法，並且沒有 HTTP 標頭。
    - 這個版本的通信非常簡單，僅限於傳輸純文本文件。
    - 伺服器只會返回一個 HTML 文件，並且在傳輸完成後立即關閉連接。
- **局限性**：
    - 缺乏擴展性和靈活性，無法支持現代 Web 所需的功能，如多媒體文件和多種內容類型的傳輸。
#### HTTP/1.0
- **引入時間**：1996 年（RFC 1945）
- **特點**：
    - 引入了 HTTP 標頭，使得傳輸數據可以包含更多的元數據（如內容類型、內容長度等）。
    - 支持多種 HTTP 方法，包括 GET、POST、HEAD 等。
    - 連接是「短連接」，也就是說，每個請求/響應對話後，連接會立即關閉。
- **局限性**：
    - 每個 HTTP 請求都需要建立和關閉一次 TCP 連接，這樣的短連接模式導致了高延遲和低效的資源利用。
#### HTTP/1.1
- **引入時間**：1997 年（RFC 2068，後來由 RFC 2616 和其他 RFC 更新）
- **特點**：
    - **持久連接**：默認使用持久連接（Keep-Alive），允許在同一 TCP 連接中傳輸多個請求/響應對話，顯著減少了延遲。
    - **管線化**：允許在同一連接上同時發送多個請求，而不需要等待前一個請求的響應完成。但實際應用中，管線化並未得到廣泛支持。
    - **額外的 HTTP 方法**：引入了 OPTIONS、PUT、DELETE 等方法。
    - **分塊傳輸編碼**：允許伺服器在響應頭未完全生成前開始發送響應，適合流式傳輸。
    - **虛擬主機支持**：同一個伺服器可以通過 Host 頭來支持多個域名。
- **局限性**：
    - 雖然有持久連接和管線化，但多路複用的支持有限，無法同時高效處理多個請求，仍存在阻塞問題（頭阻塞）。
#### HTTP/2
- **引入時間**：2015 年（RFC 7540）
- **特點**：
    - **二進制分幀**：HTTP/2 將所有通信轉換為二進制格式，而不是文本格式，這使得協議更高效。
    - **多路複用**：允許多個請求和響應同時在同一個 TCP 連接中進行，消除了 HTTP/1.1 的頭阻塞問題。
    - **頭部壓縮**：通過 HPACK 算法壓縮 HTTP 標頭，減少傳輸數據量。
    - **伺服器推送**：允許伺服器在客戶端請求前主動推送資源，提高加載效率。
- **局限性**：
    - 雖然多路複用減少了延遲，但仍然依賴於單個 TCP 連接，當丟包發生時，所有流都會受到影響（即「隊頭阻塞」）。
#### HTTP/3
- **引入時間**：2018 年（基於 QUIC 的 HTTP/2 擴展，正式標準化後由 RFC 9114 定義）
- **特點**：
    - **基於 QUIC 協議**：HTTP/3 基於 UDP 而不是 TCP，並且集成了 QUIC 協議，提供了更快的連接建立時間和更低的延遲。
    - **消除隊頭阻塞**：由於 QUIC 每個流都獨立於其他流，因此丟包不會影響其他流的進度。
    - **更好的連接恢復**：QUIC 內置連接恢復機制，當網絡切換或中斷時，可以快速恢復連接，減少中斷影響。
- **局限性**：
    - 由於基於 UDP 進行傳輸，需要伺服器和客戶端的支持，並且可能會受到一些防火牆或網絡設備的限制。

### HTTP/2 與 HTTP/3
- **兼容性**：HTTP/3 是 HTTP/2 的擴展，基於不同的底層協議（UDP 而非 TCP），但仍保持與 HTTP/2 的應用層兼容。這意味著，如果 HTTP/3 連接無法建立，客戶端和伺服器會回退到 HTTP/2 或 HTTP/1.1，這取決於客戶端和伺服器的支持情況。
- **協商過程**：HTTP/3 的協商過程與 HTTP/2 類似，使用 `ALPN` 來選擇協議版本。HTTP/3 和 HTTP/2 在同一個應用層上，因此可以靈活地根據客戶端和伺服器支持的版本進行選擇。
- **例外情況**：由於 HTTP/3 使用 QUIC 進行傳輸，因此其性能特性和行為會與基於 TCP 的 HTTP/2 不同。如果 HTTP/3 連接無法建立，系統會自動降級到 HTTP/2 或 HTTP/1.1。

#### 補充
 ##### HTTP/3 連接無法建立
上述有說到，HTTP/3 是基於 QUIC 協議（基於 UDP 的一種協議）來傳輸數據的，這與之前的 HTTP/1.x 和 HTTP/2 使用的 TCP 協議不同。由於這個根本不同，有可能會受到下面例子的影響。

- 網絡設備的限制
- 伺服器或客戶端不支持 HTTP/3
- 網絡環境或協議協商問題
- 操作系統或應用層限制

當 HTTP/3 連接無法建立時，瀏覽器或客戶端會自動降級到 HTTP/2 或 HTTP/1.1，這些協議依然基於 TCP。